<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://d3js.org/d3.v7.min.js" charset="utf-8"></script>
    <title>United States Wildfires 2000 - 2018</title>
    <link rel="stylesheet" href="./style.css" />
    
  </head>
  <body>
    <h1>How have human-made fires changed over the years?</h1>
    
    <h2>Most fire incidents are concentrated to the west of the country. That hasn't changed in the past two decades.</h2>
    <input type="range" min="2000" max="2018" value="2000" class="slider" id="myRange">
    <span style = "text-align: left;width: 50%;display: inline-block;">2000</span><span style = "text-align: right;width: 50%;display: inline-block;">2018</span>
    <p class = "yearLabel">Year shown: <span id="yearShown">2000</span></p>

    <div id="my_dataviz"><p class= "hover-instruct"><img class="icon" alt = "search icon" src = "assets/search.svg">Hover for more information</p></div>

    <script>
    // Size 
var width = 650;
var height = 400;
var widthBar = 450;
var heightBar = 250;
var margin = {top: 20, right: 30, bottom: 100, left: 130};

let activeValue = "";

var turnOffFilter = false;

var currentMapYear = '2000';

//defining variables for color legend
var colorrange = ["#7c0202", "#b64d24", "#b86213", "#e18820", "#de9b10", "#f3c523", "#7c5201", "#fac45a", "#fd860b", "#ffdc6c", "#ff4901", "#a43407"] //we can change these colors later :)
var colorrangeSoft = ["#edc4c4", "#c3a599", "#dfc4ab", "#efc493", "#e7d6b5", "#f7e5a6", "#cfc8bb", "#fce8c0", "#ffbb76", "#fff1c3", "#fa976f", "#a16851"]
var categories = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11']
var colorrangeSoft = ["#edc4c4", "#c3a599", "#dfc4ab", "#efc493", "#e7d6b5", "#f7e5a6", "#cfc8bb", "#fce8c0", "#ffbb76", "#fff1c3", "#fa976f", "#a16851"]

//defining variables for choose your state visualization
var statesDict = {"Alabama": "AL",
              "Alaska": "AK",
              "Arizona": "AZ",
              "Arkansas": "AR",
              "California": "CA",
              "Colorado": "CO",
              "Connecticut": "CT",
              "Delaware": "DE",
              "Florida": "FL",
              "Georgia": "GA",
              "Hawaii": "HI",
              "Idaho": "ID",
              "Illinois": "IL",
              "Indiana": "IN",
              "Iowa": "IA",
              "Kansas": "KS",
              "Kentucky": "KY",
              "Louisiana": "LA",
              "Maine": "ME",
              "Maryland": "MD",
              "Massachusetts": "MA",
              "Michigan": "MI",
              "Minnesota": "MN",
              "Mississippi": "MS",
              "Missouri": "MO",
              "Montana": "MT",
              "Nebraska": "NE",
              "Nevada": "NV",
              "New Hampshire": "NH",
              "New Jersey": "NJ",
              "New Mexico": "NM",
              "New York": "NY",
              "North Carolina": "NC",
              "North Dakota": "ND",
              "Ohio": "OH",
              "Oklahoma": "OK",
              "Oregon": "OR",
              "Pennsylvania": "PA",
              "Rhode Island": "RI",
              "South Carolina": "SC",
              "South Dakota": "SD",
              "Tennessee": "TN",
              "Texas": "TX",
              "Utah": "UT",
              "Vermont": "VT",
              "Virgina": "VA",
              "Washington": "WA",
              "West Virginia": "WV",
              "Wisconsin": "WI",
              "Wyoming": "WY"
            }
var states = ["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"]
var stateacr = ["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"]
var stateProjs = {"Alabama": [-82, 30, 1000],
 "Alaska": [-147, 60, 400],
 "Arizona": [-107, 30, 1000],
 "Arkansas": [-87, 31, 1000],
 "California": [-113, 34, 1000],
 "Colorado": [-100, 35, 1000],
 "Connecticut": [-70, 40, 2000],
 "Delaware": [-74, 38, 3000],
 "Florida": [-80,26,1300],
 "Georgia": [-79,30,1000],
 "Hawaii": [-155,19,2000],
 "Idaho": [-111, 43, 1000],
 "Illinois": [-84, 38, 1300],
 "Indiana": [-84, 38, 1300],
 "Iowa": [-91, 40, 1300],
 "Kansas": [-96, 37, 1300],
 "Kentucky": [-82, 35, 1300],
 "Louisiana": [-89, 30, 1300],
 "Maine": [-66, 44, 1300],
 "Maryland": [-74, 37, 1500],
 "Massachusetts": [-69, 41, 1900],
 "Michigan": [-83, 43, 1300],
 "Minnesota": [-92, 45, 1300],
 "Mississippi": [-86, 30, 1300],
 "Missouri": [-90, 37, 1400],
 "Montana": [-107, 46, 1300],
 "Nebraska": [-98,40,1300],
 "Nevada": [-115, 35, 1000],
 "New Hampshire": [-69, 43, 1700],
 "New Jersey": [-72, 38, 1900],
 "New Mexico": [-103, 30, 1000],
 "New York": [-73, 41, 1400],
 "North Carolina": [-77, 33, 1300],
 "North Dakota": [-99, 46, 1300],
 "Ohio": [-81,39,1700],
 "Oklahoma": [-95,34,1400],
 "Oregon": [-119, 43, 1300],
 "Pennsylvania": [-76, 40, 1600],
 "Rhode Island": [-70, 41, 3500],
 "South Carolina": [-79, 32, 1600],
 "South Dakota": [-99, 43, 1400],
 "Tennessee": [-82, 34, 1700],
 "Texas": [-93, 29, 1000],
 "Utah": [-110, 37, 1400],
 "Vermont": [-71, 43, 1800],
 "Virginia": [-78, 36, 1500],
 "Washington": [-118,46,1300],
 "West Virginia": [-79, 37, 1500],
 "Wisconsin": [-88, 43,1400],
 "Wyoming": [-106, 42, 1300]}


//adjusting the size of the circle for both the bubble map and the key to use
var minRadiusRange = 1;
var maxRadiusRange = 260000;

// Map projection for US
var projection = d3.geoMercator()
    .center([-96, 37])                // GPS of location to zoom on
    .scale(588)                       // This is like the zoom
    .translate([ width/2, height/2 ])

// create a tooltip
 var Tooltip = d3.select("#my_dataviz")
 .append("div")
 .attr("class", "tooltip")
 .style("opacity", 0)
 .style("background-color", "white")
 .style("border", "solid")
 .style("border-width", "2px")
 .style("border-radius", "5px")
 .style("padding", "5px")

//svg for US map
var svg = d3.select("#my_dataviz")
  .append("svg")
  .attr("width", width)
  .attr("height", height)

//main color legend
var color = d3.scaleOrdinal()
      .domain(categories)
      .range(colorrange)

//alternate color legend for bar chart
var colorSoft = d3.scaleOrdinal()
      .domain(categories)
      .range(colorrangeSoft)

 // Add a scale for bubble size
 var size = d3.scaleLinear()
 .domain([minRadiusRange,maxRadiusRange])  // What's in the data
 .range([ 2, 25])  // Size in pixel

//import wildfire data.
//could also view fires that burned more than 5,000 acress, 10,000 acres, 25,000 acres, 50,000 acres, or 75,000 acres
//to change dataset view data files in assets
d3.csv("assets/firesfinaldata.csv").then((table)=>{
  d3.json("assets/geojson/USA.geojson").then(function(data){

    //we don't show Alaska or Hawaii on the map so exclude these from US map
    let land_states = table.filter((d) => {return d.STATE != "AK"})
    land_states = land_states.filter((d) => {return d.STATE != "HI"})

    // Draw the map
    svg.append("g")
      .selectAll("path")
      .data(data.features)
      .enter()
      .append("path")
        .attr("fill", "#b8b8b8")
        .attr("d", d3.geoPath()
            .projection(projection)
        )
      .style("stroke", "black")
      .style("opacity", .3)

    // Add circles:
    svg
    .selectAll("myCircles")
    .data(land_states)
    .enter()
    //.filter(function(d) { return (d.FIRE_YEAR== "2002") })
    .append("circle")
      .attr("class" , d => "year"+d.FIRE_YEAR+" dataCircles val"+ d.VALUE+""+d.FIRE_YEAR )
      .attr("cx", function(d){ return projection([d.LONGITUDE, d.LATITUDE])[0] })
      .attr("cy", function(d){ return projection([d.LONGITUDE, d.LATITUDE])[1] })
      .attr("r", function(d){ return size(d.FIRE_SIZE) })
      .style("fill", function(d){ return color(d.VALUE) })
      .attr("stroke", function(d){ return color(d.VALUE) })
      .attr("stroke-width", 3)
      .attr("fill-opacity", .4)
    .on("mouseover", function(event, d) {
        Tooltip.style("opacity", 1);
        Tooltip.style("display", "block");
    })
    .on("mousemove", function(event, d) {
        Tooltip
          .html("Fire year: " + d.FIRE_YEAR + "<br>Acres burned: " + d.FIRE_SIZE + "<br>Cause of fire: "+ d.NWCG_GENERAL_CAUSE+"<br>State: " + d.STATE + "<br>County: " + d.FIPS_NAME)
          .style("left", (event.x)+30 + "px")
          .style("top", (event.y)-30 + "px")
    })
    .on("mouseleave", function(event, d) {
        Tooltip.style("opacity", 0);
        Tooltip.style("display", "none");
    })
                                             
                                             
    </script>


      
    <!--<center>-->
      <p></p>
      <!--<<a class="button1" href="page1.html" style="margin-right: 200px">Previous</a>-->
      <!--<font size="3" face="Arial Black">-->
      <a class="scene1" href="scene 1.html">Numbers</a>
              |
      <a class="scene2" href="scene 2.html">Causes</a>
              |
      <a class="scene3" href="scene 3.html">Severity</a>
          <!--</font>-->
      <!--<<a class="button1" href="page3-1.html" style="margin-left: 200px" >Next</a>-->
  <!--</center>-->


  </body>
</html>
